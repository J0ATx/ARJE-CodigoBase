#!/bin/bash

LOGFILE="/var/log/tanos.log"

function init() {
    case $1 in
        -l | -list)
            echo "Listando procesos..."
            ps aux | grep -E 'nftables|ssh|cron|crontab|dnf-automatic' | grep -v grep
            echo "[$(date)] Procesos listados" >> "$LOGFILE"
            ;;
        -k | -kill)
            if [ -z "$2" ]; then
                echo "Por favor, especifique un PID para matar el proceso."
                exit 1
            fi
            kill "$2"
            echo "Proceso $2 detenido."
            echo "[$(date)] Proceso $2 detenido" >> "$LOGFILE"
            ;;
        -s | -status)
            if [ -z "$2" ]; then
                echo "Por favor, especifique un PID para verificar su estado."
                exit 1
            fi
            echo "Estado del proceso $2:"
            ps -p "$2" -o pid,comm,state
            echo "[$(date)] Verifici칩n de estado del proceso PID: $2" >> "$LOGFILE"
            ;;
        -h | -help)
            echo "Uso: $0 [opci칩n] [PID]"
            echo "Opciones:"
            echo "  -l, --list       Listar los procesos relacionados con nftables, ssh, cron, crontab y dnf-automatic"
            echo "  -k, --kill       Matar un proceso por su PID"
            echo "  -s, --status     Verificar el estado de un proceso por su PID"
            echo "  -h, --help       Mostrar este mensaje de ayuda"
            ;;
        *)
            echo "Opci칩n no v치lida. Use -h o --help para ver las opciones disponibles."
            exit 1
            ;;
    esac
}

init "$@"